<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <title>ê°€ê²Œ ì£¼ë¬¸ ëª©ë¡</title>-->
<!--    <style>-->
<!--        table {-->
<!--            width: 100%;-->
<!--            border-collapse: collapse;-->
<!--            margin-top: 16px;-->
<!--        }-->

<!--        th, td {-->
<!--            padding: 10px;-->
<!--            border: 1px solid #ddd;-->
<!--            text-align: center;-->
<!--            vertical-align: top;-->
<!--        }-->

<!--        select {-->
<!--            margin-bottom: 10px;-->
<!--        }-->

<!--        .menu-list {-->
<!--            text-align: left;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<div class="container">-->
<!--    <h2>ê°€ê²Œ ì£¼ë¬¸ ëª©ë¡</h2>-->

<!--    &lt;!&ndash; ì£¼ë¬¸ ìƒíƒœ í•„í„° &ndash;&gt;-->
<!--    <label for="orderStatus">ì£¼ë¬¸ ìƒíƒœ:</label>-->
<!--    <select id="orderStatus">-->
<!--        <option value="">ì „ì²´</option>-->
<!--        <option value="WAITING">ëŒ€ê¸°</option>-->
<!--        <option value="ACCEPTED">ìˆ˜ë½ë¨</option>-->
<!--        <option value="COOKING">ì¡°ë¦¬ ì¤‘</option>-->
<!--        <option value="DELIVERY_READY">ë°°ë‹¬ ì¤€ë¹„</option>-->
<!--        <option value="COMPLETED">ì™„ë£Œ</option>-->
<!--        <option value="CANCELED">ì·¨ì†Œë¨</option>-->
<!--    </select>-->
<!--    <button id="filterBtn">ì¡°íšŒ</button>-->

<!--    &lt;!&ndash; ì£¼ë¬¸ í…Œì´ë¸” &ndash;&gt;-->
<!--    <table>-->
<!--        <thead>-->
<!--        <tr>-->
<!--            <th>ì£¼ë¬¸ ID</th>-->
<!--            <th>ê³ ê°ëª…</th>-->
<!--            <th>ì£¼ì†Œ</th>-->
<!--            <th>ë©”ë‰´ ëª©ë¡</th>-->
<!--            <th>ì£¼ë¬¸ ìƒíƒœ</th>-->
<!--            <th>ë°°ë‹¬ ìƒíƒœ</th>-->
<!--            <th>ì´ ê¸ˆì•¡</th>-->
<!--        </tr>-->
<!--        </thead>-->
<!--        <tbody id="orderTableBody">-->
<!--        &lt;!&ndash; ì£¼ë¬¸ ëª©ë¡ ë Œë”ë§ &ndash;&gt;-->
<!--        </tbody>-->
<!--    </table>-->
<!--</div>-->

<!--<script th:inline="javascript">-->
<!--    const storeId = [[${storeId}]];-->
<!--</script>-->

<!--<script>-->
<!--    document.addEventListener("DOMContentLoaded", function () {-->
<!--        const orderStatusSelect = document.getElementById("orderStatus");-->
<!--        const filterBtn = document.getElementById("filterBtn");-->

<!--        function fetchOrders() {-->
<!--            const status = orderStatusSelect.value;-->
<!--            let url = `/api/stores/${storeId}/orders`;-->

<!--            if (status) {-->
<!--                url += `?orderStatus=${status}`;-->
<!--            }-->

<!--            fetch(url)-->
<!--                .then(res => res.json())-->
<!--                .then(json => {-->
<!--                    const orders = json.data;-->
<!--                    const tbody = document.getElementById("orderTableBody");-->
<!--                    tbody.innerHTML = "";-->

<!--                    if (!orders.length) {-->
<!--                        tbody.innerHTML = `<tr><td colspan="7">ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;-->
<!--                        return;-->
<!--                    }-->

<!--                    orders.forEach(order => {-->
<!--                        const address = order.address-->
<!--                            ? `${order.address.city} ${order.address.street} ${order.address.detail}`-->
<!--                            : '-';-->

<!--                        const menuListHtml = order.orderMenus.map(menu =>-->
<!--                            `<div>- ${menu.menuName} x ${menu.quantity}</div>`-->
<!--                        ).join('');-->

<!--                        const row = `-->
<!--                            <tr>-->
<!--                                <td>${order.orderId}</td>-->
<!--                                <td>${order.customerName || "-"}</td>-->
<!--                                <td>${address}</td>-->
<!--                                <td class="menu-list">${menuListHtml}</td>-->
<!--                                <td>${order.orderStatus}</td>-->
<!--                                <td>${order.deliveryStatus}</td>-->
<!--                                <td>${order.totalPrice.toLocaleString()}ì›</td>-->
<!--                            </tr>-->
<!--                        `;-->
<!--                        tbody.insertAdjacentHTML("beforeend", row);-->
<!--                    });-->
<!--                })-->
<!--                .catch(err => {-->
<!--                    console.error("ì£¼ë¬¸ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨", err);-->
<!--                });-->
<!--        }-->

<!--        filterBtn.addEventListener("click", fetchOrders);-->
<!--        fetchOrders();-->
<!--    });-->
<!--</script>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ê°€ê²Œ ì£¼ë¬¸ ëª©ë¡</title>

    <!--â€†ğŸ–Œï¸Â ì¹´ë“œâ€‘ìŠ¤íƒ€ì¼ ì „ìš© CSS  -->
    <style>
        /* ê³µí†µ */
        * { box-sizing: border-box; }
        body { font-family: system-ui, sans-serif; margin: 0; padding: 0 1.5rem; }
        h2 { margin-top: 1.5rem; }

        /* í•„í„° ì˜ì—­ */
        .filter {
            margin-top: 1rem;
        }
        select,
        button {
            padding: 4px 8px;
            font-size: 0.95rem;
            margin-right: 4px;
        }

        /* ì£¼ë¬¸ ì¹´ë“œ ëª©ë¡ */
        .order-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1.25rem;
        }

        /* ê°œë³„ ì£¼ë¬¸ ì¹´ë“œ */
        .order-card {
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 1rem 1.25rem;
            background-color: #ffffff;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        .order-id {
            font-weight: 600;
            font-size: 1.05rem;
        }

        /* ìƒíƒœ ë±ƒì§€ */
        .status-badge {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            color: #fff;
        }
        /* ê°„ë‹¨ ìƒ‰ìƒ ì˜ˆì‹œ â€“ í•„ìš” ì‹œ ì‹¤ì œ ì£¼ë¬¸ ìƒíƒœë³„ë¡œ className ë³€ê²½ */
        .WAITING         { background: #9e9e9e; }
        .ACCEPTED        { background: #1976d2; }
        .COOKING         { background: #ef6c00; }
        .DELIVERY_READY  { background: #00796b; }
        .COMPLETED       { background: #4caf50; }
        .CANCELED        { background: #d32f2f; }

        .order-section { margin: 0.3rem 0; }
        .order-section strong { display: inline-block; width: 5.5rem; }

        /* ë©”ë‰´ ëª©ë¡ */
        .menu-list {
            margin: 0.3rem 0 0.5rem 0;
            padding-left: 1rem;
        }
        .menu-list li {
            list-style: disc;
            margin: 2px 0;
        }

        /* ì£¼ë¬¸ ì—†ì„ ë•Œ */
        .empty {
            text-align: center;
            color: #757575;
            margin-top: 2rem;
        }
    </style>
</head>
<body>
<div class="container">
    <h2>ê°€ê²Œ ì£¼ë¬¸ ëª©ë¡</h2>

    <!-- ğŸ” ì£¼ë¬¸ ìƒíƒœ í•„í„° -->
    <div class="filter">
        <label for="orderStatus">ì£¼ë¬¸ ìƒíƒœ:</label>
        <select id="orderStatus">
            <option value="">ì „ì²´</option>
            <option value="WAITING">ëŒ€ê¸°</option>
            <option value="ACCEPTED">ìˆ˜ë½ë¨</option>
            <option value="COOKING">ì¡°ë¦¬ ì¤‘</option>
            <option value="DELIVERY_READY">ë°°ë‹¬ ì¤€ë¹„</option>
            <option value="COMPLETED">ì™„ë£Œ</option>
            <option value="CANCELED">ì·¨ì†Œë¨</option>
        </select>
        <button id="filterBtn">ì¡°íšŒ</button>
    </div>

    <!-- ğŸ—‚ï¸Â ì£¼ë¬¸ ì¹´ë“œê°€ ì‚½ì…ë  ì˜ì—­ -->
    <div id="orderList" class="order-list"></div>
</div>

<!-- Thymeleaf inline scriptë¡œ storeId ì‚½ì… -->
<script th:inline="javascript">
    const storeId = [[${storeId}]];
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const orderStatusSelect = document.getElementById("orderStatus");
        const filterBtn          = document.getElementById("filterBtn");
        const orderList          = document.getElementById("orderList");

        // ğŸ› ï¸Â ì£¼ë¬¸ ì¡°íšŒ í›„ í™”ë©´ ë Œë”ë§
        function renderOrders(orders) {
            orderList.innerHTML = "";

            if (!orders.length) {
                orderList.innerHTML = '<p class="empty">ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            orders.forEach(order => {
                // ì£¼ì†Œ ë¬¸ìì—´ ì¡°í•©
                const address = order.address ?
                    `${order.address.city} ${order.address.street} ${order.address.zipcode}` : '-';

                // ë©”ë‰´ ëª©ë¡ HTML ì¡°í•©
                const menusHtml = order.orderMenus.map(menu =>
                    `<li>${menu.menuName} Ã— ${menu.count}</li>`
                ).join('');

                // ì£¼ë¬¸ ì¹´ë“œ í…œí”Œë¦¿
                const card = `
                    <div class="order-card">
                        <div class="order-header">
                            <div class="order-id">#${order.orderId}</div>
                            <span class="status-badge ${order.orderStatus}">${order.orderStatus}</span>
                        </div>

                        <div class="order-section"><strong>ê³ ê°ëª…:</strong> ${order.customerName || '-'}</div>
                        <div class="order-section"><strong>ì£¼ì†Œ:</strong> ${address}</div>

                        <div class="order-section"><strong>ë©”ë‰´:</strong></div>
                        <ul class="menu-list">${menusHtml}</ul>

                        <div class="order-section"><strong>ë°°ë‹¬ ìƒíƒœ:</strong> ${order.deliveryStatus}</div>
                        <div class="order-section"><strong>ì´ ê¸ˆì•¡:</strong> ${order.totalPrice.toLocaleString()}ì›</div>
                    </div>
                `;

                orderList.insertAdjacentHTML("beforeend", card);
            });
        }

        // ğŸ“¡Â API í˜¸ì¶œ í•¨ìˆ˜
        function fetchOrders() {
            const status = orderStatusSelect.value;
            let url = `/api/stores/${storeId}/orders`;
            if (status) {
                url += `?orderStatus=${status}`;
            }

            fetch(url)
                .then(res => res.json())
                .then(json => renderOrders(json.data))
                .catch(err => {
                    console.error("ì£¼ë¬¸ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨", err);
                });
        }

        // ì´ë²¤íŠ¸ ë°”ì¸ë”© & ì´ˆê¸° í˜¸ì¶œ
        filterBtn.addEventListener("click", fetchOrders);
        fetchOrders();
    });
</script>
</body>
</html>